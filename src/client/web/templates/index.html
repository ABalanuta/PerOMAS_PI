{% extends "base.html" %}
{% block content %}
	<h2><b>Ambient</2></h3>
	<div class="well container-fluid" style="max-width:900px;" >
		<div class="row">
			<div class="col-md-3">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<h3 class="panel-title"><b>Temperature</b></h3>
					</div>
					<div class="panel-body">
						<h4><b>{{temp}} ÂºC </b></h4>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<h3 class="panel-title"><b>Relative Humidity</b></h3>
					</div>
					<div class="panel-body">
						<h4><b>{{humid}} %</b></h4>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<h3 class="panel-title"><b>Luminosity</b></h3>
					</div>
					<div class="panel-body">
						<h4><b>{{lux}} Lux</b></h4>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<h3 class="panel-title"><b>Power</b></h3>
					</div>
					<div class="panel-body">
						<h4><b>{{current}} Watts</b></h4>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-3">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<h3 class="panel-title"><b>Last Update</b></h3>
					</div>
					<div class="panel-body">
						<h4><b>{{last_update}}</b></h4>
					</div>
				</div>
			</div>
			{% if g.user.username %}
				<div class="col-md-3">
					<div class="panel panel-primary">
						<div class="panel-heading">
							<h3 class="panel-title"><b>AC Mode</b></h3>
						</div>
						<div class="panel-body">
							<form method="POST">
								<div class="btn-group vcenter">
									{% if mode == "Auto" %}
										<button type="submit" name="AC_Auto" class="btn btn-primary disabled">
										<b>Auto</b>
										</button>
									{% else %}
										<button type="submit" name="AC_Auto" class="btn btn-default">
										<b>Auto</b>
										</button>
									{% endif %}
									{% if mode == "Manual" %}
										<button type="submit" name="AC_Manual" class="btn btn-primary disabled">
										<b>Manual</b>
										</button>
									{% else %}
										<button type="submit" name="AC_Manual" class="btn btn-default">
										<b>Manual</b>
										</button>
									{% endif %}
								</div>
								<form>
								</div>
							</div>
						</div>
					{% endif %}
					{% if g.user.username and mode != "Auto" %}
						<div class="col-md-6">
							<div class="panel panel-primary">
								<div class="panel-heading">
									<h3 class="panel-title"><b>AC Control</b></h3>
								</div>
								<div class="panel-body">
									<form method="POST">
										<div class="row vcenter">
											<div class="btn-group">
												{% if ac_heat_or_cool == "Cool" %}
													<button type="submit" name="AC_COOL" class="btn btn-info disabled">
													<span class="glyphicon glyphicon-asterisk"></span>
													<b>Cool</b>
													</button>
												{% else %}
													<button type="submit" name="AC_COOL" class="btn btn-info">
													<span class="glyphicon glyphicon-asterisk"></span>
													<b>Cool</b>
													</button>
												{% endif %}
												{% if ac_heat_or_cool == "Heat" %}
													<button type="submit" name="AC_HEAT" class="btn btn-danger disabled">
													<span class="glyphicon glyphicon-fire"></span>
													<b>Heat</b>
													</button>
												{% else %}
													<button type="submit" name="AC_HEAT" class="btn btn-danger">
													<span class="glyphicon glyphicon-fire"></span>
													<b>Heat</b>
													</button>
												{% endif %}
											</div>
											<div class="btn-group" style="margin-left: 20px;">
												{% if speed == 0 %}
													<button type="submit" name="AC_OFF" class="btn btn-primary disabled">
													<b>OFF</b>
													</button>
												{% else %}
													<button type="submit" name="AC_OFF" class="btn btn-default">
													<b>OFF</b>
													</button>
												{% endif %}
												{% if speed == 1 %}
													<button type="submit" name="AC_1" class="btn btn-success disabled">
													<b>1</b>
													</button>
												{% else %}
													<button type="submit" name="AC_1" class="btn btn-default">
													<b>1</b>
													</button>
												{% endif %}
												{% if speed == 2 %}
													<button type="submit" name="AC_2" class="btn btn-warning  disabled">
													<b>2</b>
													</button>
												{% else %}
													<button type="submit" name="AC_2" class="btn btn-default ">
													<b>2</b>
													</button>
												{% endif %}
												{% if speed == 3 %}
													<button type="submit" name="AC_3" class="btn btn-danger disabled">
													<b>3</b>
													</button>
												{% else %}
													<button type="submit" name="AC_3" class="btn btn-default">
													<b>3</b>
													</button>
												{% endif %}
											</div>
										</div>
									</div>
									<form>
									</div>
								</div>
							</div>
						{% endif %}
						{% if g.user.username and setpoint and mode == "Auto" %}
							<div class="col-md-6">
								<div class="panel panel-primary">
									<div class="panel-heading">
										<h3 class="panel-title"><b>AC Setpoint</b></h3>
									</div>
									<div class="panel-body">
										<div class="col-md-12">
											<form method="POST" name="setpointForm">
												<div class="col-md-8">
													<br>
													<div id="rangeslider"></div>
													<br>
												</div>
												
												<button type="submit" id="ButtonSetpoint" name="Setpoint" class="col-md-4 btn btn-primary" value={{ setpoint }}>
												Save: <span id="rangeval">{{ setpoint }}</span>
												</button>
											</form>
										</div>
									</div>
									<script>
									$(function(){
										$('#rangeslider').slider({
											min: 18.0,
											step: 0.5,
											max: 28.0,
											value: [ {{ setpoint }} ],
											slide: function( event, ui ) {
												$('#rangeval').html(ui.value.toFixed(1));
												document.getElementById('ButtonSetpoint').value = ui.value.toFixed(1);
											}
										});
									});
									</script>
								</div>
							</div>
						{% endif %}
						
						<div class="row">
							{% if g.user.username %}
								<div class="col-md-6">
									<div class="panel panel-primary">
										<div class="panel-heading">
											<h3 class="panel-title"><b>Lights</b></h3>
										</div>
										<div class="panel-body">
											<form method="POST">
												<div class="col-md-6">
													{% if light_bulb[0] %}
														<button type="submit" name="Light_1" class="btn btn-warning">
														<span class="octicon octicon-light-bulb"></span>
														<b>Light Bulb 1</b>
														</button>
													{% else %}
														<button type="submit" name="Light_1" class="btn btn-default">
														<span class="octicon octicon-light-bulb"></span>
														<b>Light Bulb 1</b>
														</button>
													{% endif %}
												</div>
												<div class="col-md-6">
													{% if light_bulb[1] %}
														<button type="submit" name="Light_2" class="btn btn-warning">
														<span class="octicon octicon-light-bulb"></span>
														<span class="octicon octicon-light-bulb"></span>
														<b>Light Bulb 2</b>
														</button>
													{% else %}
														<button type="submit" name="Light_2" class="btn btn-default">
														<span class="octicon octicon-light-bulb"></span>
														<span class="octicon octicon-light-bulb"></span>
														<b>Light Bulb 2</b>
														</button>
													{% endif %}
												</div>
												<form>
												</div>
											</div>
										</div>
									</div>
								{% endif %}
							</div>
						</div>
						{% if g.user.username %}
							<h2><b>Presence</2></h3>
							<div class="well well-lg" style="max-width:900px;">
								<div class="row">
									<table class="table table-condensed table-bordered">
										<thead>
											<tr>
												<th>Username</th>
												<th>Device</th>
											</tr>
										</thead>
										{% for name, mac in present_devices.items() %}
											<tr class="success">
												<td class="text-left">{{ name }}</td>
												<td class="text-left">{{ mac }}</td>
											</tr>
										{% endfor %}
									</table>
								</div>
							</div>
							<h2><b>Logs</2></h3>
							<div class="well well-lg" style="max-width:900px;">
								<div class="row">
									<table class="table table-condensed table-bordered">
										<thead>
											<tr>
												<th>Timestamp</th>
												<th>User</th>
												<th>Message</th>
											</tr>
										</thead>
										{% for log in logs %}
											<tr>
												<td class="text-left">{{ log[0] }}</td>
												<td class="text-left">{{ log[1] }}</td>
												<td class="text-left">{{ log[2].encode('ascii', 'ignore') }}</td>
											</tr>
										{% endfor %}
									</table>
								{% endif %}
							</div>
						{% endblock %}